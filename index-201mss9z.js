var F={mapSize:200000},w=F;var I=(e)=>{let t=new Float32Array(e*2),c=new Float32Array(e*2),i=new Float32Array(e*2);return{size:e,init(n,m,r,o,d,g){t[n*2]=m,t[n*2+1]=r,c[n*2]=d,c[n*2+1]=g,i[n]=o},getX(n){return t[n*2]},getY(n){return t[n*2+1]},getVX(n){return c[n*2]},getVY(n){return c[n*2+1]},getRadius(n){return i[n]},update(n,m){let r=n*2,o=r+1,d=c[r],g=c[o],l=i[n],p=w.mapSize;if(t[r]+=d*m,t[o]+=g*m,t[r]<=l)t[r]=l,c[r]=-d;else if(t[r]>=p-l)t[r]=p-l,c[r]=-d;if(t[o]<=l)t[o]=l,c[o]=-g;else if(t[o]>=p-l)t[o]=p-l,c[o]=-g}}},_=I;var q=Math.PI,T=q*2,E=(e,t)=>{return Math.floor(Math.random()*(t-e+1))+e},P=(e,t,c)=>{return e+(t-e)*c};var h=document.querySelector("canvas"),a=h.getContext("2d",{alpha:!1}),z={w:1920,h:1080},y=0.05,f=1,x=0,M=1,s={x:w.mapSize/2,y:w.mapSize/2,lx:w.mapSize/2,ly:w.mapSize/2},u={x:0,y:0,dragging:!1},Y=()=>{M=window.devicePixelRatio||1;let{innerWidth:e,innerHeight:t}=window;if(f=Math.max(e/z.w,t/z.h)*M*y,h.width=e*M,h.height=t*M,x===0)x=f};Y();window.addEventListener("resize",Y);window.addEventListener("wheel",(e)=>{if(e.deltaY<0)y*=1.15;else y/=1.15;y=Math.min(y,1);let c=h.getBoundingClientRect(),i=(e.clientX-c.left)*M,n=(e.clientY-c.top)*M,m=h.width/f,r=h.height/f,o={x:i/f-m/2+s.x,y:n/f-r/2+s.y};Y();let d=h.width/f,g=h.height/f,l={x:i/f-d/2+s.x,y:n/f-g/2+s.y};s.x+=o.x-l.x,s.y+=o.y-l.y});h.addEventListener("mousedown",(e)=>{u.dragging=!0,u.x=e.clientX,u.y=e.clientY});var k=()=>{u.dragging=!1};h.addEventListener("mouseup",k);h.addEventListener("mouseleave",k);h.addEventListener("mousemove",(e)=>{if(!u.dragging)return;let t=(e.clientX-u.x)/f*M,c=(e.clientY-u.y)/f*M;s.x-=t,s.y-=c,u.x=e.clientX,u.y=e.clientY});var S=_(5000);for(let e=0;e<S.size;e++){let t=Math.floor(1500/(e+1)*10)+300,c=E(t,w.mapSize-t),i=E(t,w.mapSize-t),n=Math.random()*T,m=E(1,10),r=Math.cos(n)*m,o=Math.sin(n)*m;S.init(e,c,i,t,r,o)}var v=(e)=>{a.save(),a.font="600 20px sans-serif",a.textAlign="left",a.textBaseline="top",a.setTransform(1,0,0,1,0,0),a.fillStyle="#f1f1f1",a.strokeStyle="#4d4848",a.lineWidth=6,a.letterSpacing="4px",a.lineJoin="round",a.strokeText(e,5,5),a.fillText(e,5,5),a.restore()},b=[],L=performance.now(),R=0,X=performance.now(),C=()=>{requestAnimationFrame(C);let e=performance.now();while(b.length>0&&b[0]<=e-1000)b.shift();b.push(e);let t=b.length;if(e-L>=1000)R=t,L=e;let c=e-X;X=e;let i=(1-Math.exp(-10*c/1000))*0.4;s.lx=P(s.lx,s.x,i),s.ly=P(s.ly,s.y,i),x=P(x,f,i);let n=h.width/x,m=h.height/x;a.clearRect(0,0,n,m),a.fillStyle="#98b979",a.fillRect(0,0,n,m);let r=s.lx-n/2,o=s.ly-m/2;a.save(),a.setTransform(x,0,0,x,0,0),a.translate(-r,-o),a.fillStyle="#a6ca85",a.fillRect(0,0,w.mapSize,w.mapSize),a.fillStyle="#D66969";for(let d=0;d<S.size;d++){S.update(d,c);let g=S.getX(d),l=S.getY(d),p=S.getRadius(d);if(g+p<r||g-p>r+n||l+p<o||l-p>o+m)continue;a.beginPath(),a.arc(g,l,p,0,T),a.fill()}a.restore(),v(`Entities: ${S.size}, FPS: ${R}`)};requestAnimationFrame(C);
