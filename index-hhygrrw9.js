var y={mapSize:200000},P=y;var m=(b)=>{let k=new Float32Array(b*2),q=new Float32Array(b*2),B=new Float32Array(b*2);return{size:b,init(j,L,G,J,$,F){k[j*2]=L,k[j*2+1]=G,q[j*2]=$,q[j*2+1]=F,B[j]=J},getX(j){return k[j*2]},getY(j){return k[j*2+1]},getVX(j){return q[j*2]},getVY(j){return q[j*2+1]},getRadius(j){return B[j]},update(j,L){let G=j*2,J=G+1,$=q[G],F=q[J],O=B[j],U=P.mapSize;if(k[G]+=$*L,k[J]+=F*L,k[G]<=O)k[G]=O,q[G]=-$;else if(k[G]>=U-O)k[G]=U-O,q[G]=-$;if(k[J]<=O)k[J]=O,q[J]=-F;else if(k[J]>=U-O)k[J]=U-O,q[J]=-F}}},X=m;var l=Math.PI,Y=l*2,T=(b,k)=>{return Math.floor(Math.random()*(k-b+1))+b},W=(b,k,q)=>{return b+(k-b)*q},D=(b,k)=>{let q=b.clientX-k.clientX,B=b.clientY-k.clientY;return Math.sqrt(q*q+B*B)},h=(b,k)=>({x:(b.clientX+k.clientX)/2,y:(b.clientY+k.clientY)/2});var K=document.querySelector("canvas"),I=K.getContext("2d",{alpha:!1}),M={w:1920,h:1080},S=0.05,N=1,Z=0,E=1,V={x:P.mapSize/2,y:P.mapSize/2,lx:P.mapSize/2,ly:P.mapSize/2},Q={x:0,y:0,dragging:!1},R=()=>{E=window.devicePixelRatio||1;let{innerWidth:b,innerHeight:k}=window;if(N=Math.max(b/M.w,k/M.h)*E*S,K.width=b*E,K.height=k*E,Z===0)Z=N};R();window.addEventListener("resize",R);var z=(b,k,q)=>{S=Math.min(b,1);let B=K.width/N,j=K.height/N,L={x:k/N-B/2+V.x,y:q/N-j/2+V.y};R();let G=K.width/N,J=K.height/N,$={x:k/N-G/2+V.x,y:q/N-J/2+V.y};V.x+=L.x-$.x,V.y+=L.y-$.y};window.addEventListener("wheel",(b)=>{if(b.deltaY<0)S*=1.15;else S/=1.15;let q=K.getBoundingClientRect(),B=(b.clientX-q.left)*E,j=(b.clientY-q.top)*E;z(S,B,j)});K.addEventListener("mousedown",(b)=>{Q.dragging=!0,Q.x=b.clientX,Q.y=b.clientY});var w=()=>{Q.dragging=!1};K.addEventListener("mouseup",w);K.addEventListener("mouseleave",w);var u=(b,k)=>{if(!Q.dragging)return;let q=(b-Q.x)/N*E,B=(k-Q.y)/N*E;V.x-=q,V.y-=B,Q.x=b,Q.y=k};K.addEventListener("mousemove",(b)=>{u(b.clientX,b.clientY)});var H=null;K.addEventListener("touchstart",(b)=>{if(b.touches.length===1){let k=b.touches[0];Q.dragging=!0,Q.x=k.clientX,Q.y=k.clientY}else if(b.touches.length===2)H=D(b.touches[0],b.touches[1])});K.addEventListener("touchmove",(b)=>{if(b.preventDefault(),b.touches.length===1&&Q.dragging){let k=b.touches[0];u(k.clientX,k.clientY)}else if(b.touches.length===2){let k=D(b.touches[0],b.touches[1]),q=h(b.touches[0],b.touches[1]),B=K.getBoundingClientRect(),j=(q.x-B.left)*E,L=(q.y-B.top)*E;if(H){let G=k/H;z(S*G,j,L)}H=k}},{passive:!1});K.addEventListener("touchend",(b)=>{if(b.touches.length<2)H=null;if(b.touches.length===1){let k=b.touches[0];Q.x=k.clientX,Q.y=k.clientY,Q.dragging=!0}else if(b.touches.length===0)Q.dragging=!1});var A=X(5000);for(let b=0;b<A.size;b++){let k=Math.floor(1500/(b+1)*10)+300,q=T(k,P.mapSize-k),B=T(k,P.mapSize-k),j=Math.random()*Y,L=T(1,10),G=Math.cos(j)*L,J=Math.sin(j)*L;A.init(b,q,B,k,G,J)}var x=(b)=>{I.save(),I.font="600 20px sans-serif",I.textAlign="left",I.textBaseline="top",I.setTransform(1,0,0,1,0,0),I.fillStyle="#f1f1f1",I.strokeStyle="#4d4848",I.lineWidth=6,I.letterSpacing="4px",I.lineJoin="round",I.strokeText(b,5,5),I.fillText(b,5,5),I.restore()},C=[],f=performance.now(),_=0,p=performance.now(),g=()=>{requestAnimationFrame(g);let b=performance.now();while(C.length>0&&C[0]<=b-1000)C.shift();C.push(b);let k=C.length;if(b-f>=1000)_=k,f=b;let q=b-p;p=b;let B=(1-Math.exp(-10*q/1000))*0.4;V.lx=W(V.lx,V.x,B),V.ly=W(V.ly,V.y,B),Z=W(Z,N,B);let j=K.width/Z,L=K.height/Z;I.clearRect(0,0,j,L),I.fillStyle="#98b979",I.fillRect(0,0,j,L);let G=V.lx-j/2,J=V.ly-L/2;I.save(),I.setTransform(Z,0,0,Z,0,0),I.translate(-G,-J),I.fillStyle="#a6ca85",I.fillRect(0,0,P.mapSize,P.mapSize),I.fillStyle="#D66969";for(let $=0;$<A.size;$++){A.update($,q);let F=A.getX($),O=A.getY($),U=A.getRadius($);if(F+U<G||F-U>G+j||O+U<J||O-U>J+L)continue;I.beginPath(),I.arc(F,O,U,0,Y),I.fill()}I.restore(),x(`Entities: ${A.size}, FPS: ${_}`)};requestAnimationFrame(g);
